{"version":3,"sources":["../../src/broker/channel.js"],"names":["url","process","env","AMQP_URL","createQueueChannel","queue","cb","onceConnected","err","conn","console","error","stack","log","createChannel","onceChannelCreated","channel","assertQueue","durable","onceQueueCreated"],"mappings":"2EAAA;AACA,IAAMA,MAAMC,QAAQC,GAAR,CAAYC,QAAZ,IAAwB,mCAApC;;AAEA,SAASC,kBAAT,CAA4BC,KAA5B,EAAmCC,EAAnC,EAAuC;AACnC,+BAAQN,GAAR,EAAaO,aAAb;;AAEA,aAASA,aAAT,CAAuBC,GAAvB,EAA4BC,IAA5B,EAAkC;AAC9B,YAAID,GAAJ,EAAS;AACLE,oBAAQC,KAAR,CAAc,mBAAd,EAAmCH,IAAII,KAAvC;AACH,SAFD,MAEM;AACFF,oBAAQG,GAAR,CAAY,WAAZ;AACAJ,iBAAKK,aAAL,CAAmBC,kBAAnB;AACH;;AAED,iBAASA,kBAAT,CAA4BP,GAA5B,EAAiCQ,OAAjC,EAA0C;AACtC,gBAAIR,GAAJ,EAAS;AACLF,mBAAGE,GAAH;AACH,aAFD,MAEM;AACFQ,wBAAQC,WAAR,CAAoBZ,KAApB,EAA2B;AACvBa,6BAAS,IADc,EAA3B;AAEGC,gCAFH;AAGH;;AAED,qBAASA,gBAAT,CAA0BX,GAA1B,EAA+B;AAC3B,oBAAIA,GAAJ,EAAS;AACLF,uBAAGE,GAAH;AACH,iBAFD,MAEM;AACFF,uBAAG,IAAH,EAASU,OAAT,EAAkBP,IAAlB;AACH;AACJ;AACJ;AACJ;AACJ,C;;AAEcL,kB","file":"channel.js","sourcesContent":["import { connect }from 'amqplib/callback_api';\r\nconst url = process.env.AMQP_URL || 'amqp://guest:guest@localhost:5672';\r\n\r\nfunction createQueueChannel(queue, cb) {\r\n    connect(url, onceConnected);\r\n\r\n    function onceConnected(err, conn) {\r\n        if (err) {\r\n            console.error('Error connecting:', err.stack);\r\n        }else {\r\n            console.log('connected');\r\n            conn.createChannel(onceChannelCreated);\r\n        }\r\n\r\n        function onceChannelCreated(err, channel) {\r\n            if (err) {\r\n                cb(err);\r\n            }else {\r\n                channel.assertQueue(queue, {\r\n                    durable: true\r\n                }, onceQueueCreated);\r\n            }\r\n\r\n            function onceQueueCreated(err) {\r\n                if (err) {\r\n                    cb(err);\r\n                }else {\r\n                    cb(null, channel, conn);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport default createQueueChannel;\r\n"]}