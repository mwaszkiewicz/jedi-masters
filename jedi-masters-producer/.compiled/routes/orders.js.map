{"version":3,"sources":["../../src/routes/orders.js"],"names":["publisher","Publisher","action","req","res","validator","validationAdd","body","abortEarly","then","validatedOrderPart","publish","status","send","catch","validationError","errorMessage","details","map","d","message"],"mappings":"2EAAA,+C;AACA,gD;;AAEA,IAAMA,YAAY,IAAIC,mBAAJ,EAAlB;;AAEA,IAAMC,SAAS,SAATA,MAAS,CAACC,GAAD,EAAMC,GAAN,EAAc;AACzBC,wBAAUC,aAAV,CAAwBH,IAAII,IAA5B,EAAkC,EAAEC,YAAY,KAAd,EAAlC;AACKC,QADL,CACU,UAACC,kBAAD,EAAwB;AAC1BV,kBAAUW,OAAV,CAAkBD,kBAAlB,EAAsC,KAAtC;AACAN,YAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,MAArB;AACH,KAJL;AAKKC,SALL,CAKW,UAACC,eAAD,EAAqB;AACxB,YAAMC,eAAeD,gBAAgBE,OAAhB,CAAwBC,GAAxB,CAA4B,UAACC,CAAD,EAAO;AACpE,mBAAOA,EAAEC,OAAT;AACC,SAFgC,CAArB;AAGAhB,YAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBG,YAArB;AACH,KAVL;AAWH,CAZD,C;;AAce,UAACb,GAAD,EAAMC,GAAN,EAAc;AAC7B,WAAOF,OAAOC,GAAP,EAAYC,GAAZ,CAAP;AACC,C","file":"orders.js","sourcesContent":["import validator from '../utils/validator';\r\nimport Publisher from '../broker/publisher';\r\n\r\nconst publisher = new Publisher();\r\n\r\nconst action = (req, res) => {\r\n    validator.validationAdd(req.body, { abortEarly: false })\r\n        .then((validatedOrderPart) => {\r\n            publisher.publish(validatedOrderPart, 'add');\r\n            res.status(201).send('Sent');\r\n        })\r\n        .catch((validationError) => {\r\n            const errorMessage = validationError.details.map((d) => {\r\nreturn d.message;\r\n});\r\n            res.status(400).send(errorMessage);\r\n        });\r\n};\r\n\r\nexport default (req, res) => {\r\nreturn action(req, res);\r\n};\r\n"]}