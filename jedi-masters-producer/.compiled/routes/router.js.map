{"version":3,"sources":["../../src/routes/router.js"],"names":["publisher","Publisher","action","req","res","queue","validator","validationAdd","body","abortEarly","then","validatedReq","publish","status","send","catch","err","validationError","validate"],"mappings":"2EAAA,gD;AACA,+C;;AAEA,IAAMA,YAAY,IAAIC,mBAAJ,EAAlB;;AAEA,IAAMC,SAAS,SAATA,MAAS,CAACC,GAAD,EAAMC,GAAN,EAAWC,KAAX,EAAqB;AAChCC,wBAAUC,aAAV,CAAwBJ,IAAIK,IAA5B,EAAkC,EAAEC,YAAY,KAAd,EAAlC;AACKC,QADL,CACU,UAACC,YAAD,EAAkB;AACpBX,kBAAUY,OAAV,CAAkBD,YAAlB,EAAgCN,KAAhC;AACKK,YADL,CACU,UAACN,GAAD,EAAS,CAACA,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,MAArB,EAA8B,CADlD;AAEKC,aAFL,CAEW,UAACC,GAAD,EAAS,CAACZ,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBE,GAArB,EAA2B,CAFhD;AAGH,KALL;AAMKD,SANL,CAMW,UAACE,eAAD,EAAqB;AACxB;AACA;AACA;AACAb,YAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBG,eAArB;AACH,KAXL;AAYH,CAbD,C;;AAee,UAACd,GAAD,EAAMC,GAAN,EAAWc,QAAX,EAAqBb,KAArB,EAA+B;AAC1C,WAAOH,OAAOC,GAAP,EAAYC,GAAZ,EAAiBc,QAAjB,EAA2Bb,KAA3B,CAAP;AACH,C","file":"router.js","sourcesContent":["import Publisher from '../broker/publisher';\r\nimport validator from '../utils/validator';\r\n\r\nconst publisher = new Publisher();\r\n\r\nconst action = (req, res, queue) => {\r\n    validator.validationAdd(req.body, { abortEarly: false })\r\n        .then((validatedReq) => {\r\n            publisher.publish(validatedReq, queue)\r\n                .then((res) => {res.status(201).send('Sent');})\r\n                .catch((err) => {res.status(400).send(err);});\r\n        })\r\n        .catch((validationError) => {\r\n            // const errorMessage = validationError.details.map((d) => {\r\n            //     return d.message;\r\n            // });\r\n            res.status(400).send(validationError);\r\n        });\r\n};\r\n\r\nexport default (req, res, validate, queue) => {\r\n    return action(req, res, validate, queue);\r\n};\r\n"]}